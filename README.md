
# CrowdSpot – AI-Driven Crowd Intelligence System

## Overview

CrowdSpot is an AI-driven system designed to assist police patrol and bandobast operations by analyzing crowd patterns from visual inputs. The system focuses on **crowd analysis, anomaly detection, automated alerts, and patrol intelligence summaries**, while ensuring that AI acts as a **decision-support tool**, not a decision-maker.

This implementation uses static images from the ShanghaiTech dataset to simulate CCTV feeds and demonstrates how such a system can function in real-world policing scenarios.

---

## Problem Context

In large public spaces, police officers need timely awareness of crowd conditions to plan patrols and manage bandobast effectively. Manual monitoring of multiple camera feeds is inefficient and error-prone.

CrowdSpot uses computer vision and statistical modeling to:

* Detect people in images
* Estimate crowd density
* Identify abnormal crowd patterns
* Generate clear, factual summaries for supervisors

The system avoids intent inference and focuses strictly on observable data.

---

## Dataset Assumptions (ShanghaiTech)

* ShanghaiTech images are treated as **independent CCTV captures**
* There is **no real video continuity**
* Images do not have timestamps, so **synthetic timestamps** are assigned
* Each image represents a single **zone snapshot**

This design choice ensures realism without misrepresenting the dataset.

---

## System Pipeline

### 1. Image Input

* Input consists of ShanghaiTech images
* Images are processed sequentially
* Each image is treated as a separate zone capture

---

### 2. Person Detection

* YOLOv8 is applied to each image
* For each detected person:

  * Bounding box centroid (x, y) is extracted
  * Confidence score is recorded
* Total person count per image is computed

---

### 3. Crowd Density Estimation

#### 3.1 Global Density

* Compute:

  ```
  global_density = person_count / image_area
  ```
* Density is normalized to account for image size differences
* This signal is used for baseline comparison and anomaly detection

#### 3.2 Density Bucketing (Final Approach)

Density levels are derived **relative to the global baseline**, not hardcoded thresholds.

```
LOW     : density < (baseline_mean − 0.25 × baseline_std)
MEDIUM  : baseline_mean − 0.25 × std ≤ density < baseline_mean + 1.25 × std
HIGH    : density ≥ baseline_mean + 1.25 × std
```

This makes density classification adaptive to the dataset.

---

### 4. Baseline Computation

* A **global baseline** is calculated using all images:

  * Mean density
  * Standard deviation
* This represents typical crowd conditions across zones
* No time-based baselines are used due to static data

---

### 5. Anomaly Detection (Simplified)

Because images are not temporally continuous:

* No persistence or debounce logic is applied
* Each image is evaluated independently

For each image:

```
z_score = (current_density − baseline_mean) / baseline_std
```

Severity is assigned as:

* HIGH: z_score > 2.0
* MEDIUM: 1.5 < z_score ≤ 2.0
* LOW: z_score ≤ 1.5

An anomaly is flagged when deviation is statistically significant.

---

### 6. Alert Generation

Alerts are generated only when anomaly severity crosses defined thresholds.

Each alert includes:

* Image ID (zone)
* Severity
* Person count
* Density deviation (z-score)
* Operator note (contextual, factual)

Alert lifecycle and expiry are intentionally excluded, as images are static snapshots.

---

### 7. LLM-Based Patrol Summary

An LLM is used to generate **short, factual summaries** for patrol supervisors.

#### Inputs to LLM:

* Image ID (zone)
* Person count
* Density level (LOW / MEDIUM / HIGH)
* Baseline mean and standard deviation
* Z-score deviation

#### Prompt Design Principles:

* No intent inference
* No alarmist language
* Operationally relevant
* 2–3 sentences maximum

The LLM does **not** hallucinate causes or motivations.

---

### 8. Streamlit Dashboard

#### Zone Overview

* Table showing:

  * Image ID
  * Density level
  * Trend indicator
  * Alert count

#### Density Distribution

* Histogram of global densities across all images
* Visual markers:

  * Baseline mean
  * Baseline ± standard deviation
* Shows where each image lies relative to typical conditions

#### Active Alerts

* Displays alerts generated by anomaly logic
* Intended to simulate how a backend system would surface issues

#### Summary Generator

* Dropdown to select an image
* Generates patrol summary using the LLM

---

## Data Storage (CSV-Based Backend)

### frames.csv

* image_id
* synthetic_timestamp
* person_count
* global_density
* density_level
* confidence

### baselines.csv

* metric
* value

### anomalies.csv

* image_id
* person_count
* global_density
* z_score
* severity
* anomaly_type

### alerts.csv

* image_id
* severity
* message
* operator_note
* status

---

## What This System Does and Does Not Do

### Implemented

* Person detection
* Crowd density estimation
* Adaptive density bucketing
* Statistical anomaly detection
* Automated alerts
* LLM-based patrol summaries
* End-to-end dashboard integration

### Explicitly Not Implemented

* Temporal trend analysis
* Motion-based behavior detection
* Alert lifecycle management
* Intent or threat prediction

These are excluded deliberately due to dataset limitations.

---

## Key Design Philosophy

* AI assists officers, it does not replace judgment
* All outputs are explainable and grounded in data
* False positives are minimized using statistical baselines
* Cost-aware LLM usage with constrained prompts
* Modular design allows future extension to real CCTV streams

---

## Design Trade-offs and Limitations

This project makes several deliberate trade-offs to balance realism, explainability, and feasibility within the constraints of the dataset and assessment scope.

### Static Images vs Video Streams

The ShanghaiTech dataset consists of independent images rather than continuous video. As a result, the system treats each image as a standalone snapshot and does not model temporal continuity, motion patterns, or crowd flow. This limits the ability to detect movement-based behaviors but allows reliable density and anomaly analysis without misrepresenting the data.

### Global Baseline vs Zone-Specific Baselines

A single global baseline is computed across all images instead of maintaining per-zone or time-of-day baselines. This simplifies the anomaly detection logic and avoids overfitting to sparse data, at the cost of reduced location-specific sensitivity.

### Statistical Anomaly Detection vs Learned Behavior Models

Anomaly detection is based on statistical deviation (z-score) rather than trained behavioral models. This choice improves transparency, reduces false positives, and avoids black-box behavior, but does not capture complex semantic activities.

### Density Bucketing vs Absolute Crowd Counts

Crowd density levels (LOW / MEDIUM / HIGH) are derived relative to dataset statistics instead of absolute thresholds. This makes the system adaptive across datasets, but means density levels are comparative rather than universal.

### LLM Summaries as Assistance, Not Decision Output

The LLM is used strictly for summarization and context generation. It does not make decisions, predict intent, or recommend enforcement actions. This reduces operational risk and ensures that human officers remain the final decision-makers.

### CSV-Based Storage vs Production Databases

CSV files are used to store intermediate and final outputs for simplicity and inspectability. In a production system, these would be replaced with databases or streaming pipelines.

